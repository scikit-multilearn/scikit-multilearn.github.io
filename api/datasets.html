

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The data format for multi-label classification &mdash; scikit-multilearn 0.0.5 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="scikit-multilearn 0.0.5 documentation" href="index.html"/>
        <link rel="next" title="Loading and generating multi-label datasets" href="loading.html"/>
        <link rel="prev" title="Concepts guide" href="concepts.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> scikit-multilearn
          

          
          </a>

          
            
            
              <div class="version">
                0.0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The data format for multi-label classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-multi-label-data-representation">The multi-label data representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#single-label-representations-in-problem-transfortion">Single-label representations in problem transfortion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#converting-from-array-of-arrays">Converting from array of arrays</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="loading.html">Loading and generating multi-label datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="classify.html">Selecting a multi-label classifier</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="model_estimation.html">Estimating parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="meka.html">Using the meka wrapper</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer&#8217;s Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="base.html">Implementing a multi-label classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="clusterer.html">Developing a label space clusterer</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/scikit-multilearn/scikit-multilearn/blob/master/CHANGES.md">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/skmultilearn.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">scikit-multilearn</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>The data format for multi-label classification</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/datasets.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-data-format-for-multi-label-classification">
<span id="datasets"></span><h1>The data format for multi-label classification<a class="headerlink" href="#the-data-format-for-multi-label-classification" title="Permalink to this headline">¶</a></h1>
<p>In this section you will learn about the data format scikit-multilearn expects.</p>
<p>In order to train a classification model we need data about a phenomenon that the classifier is supposed to generalize. Such data usually comes in two parts:</p>
<ul class="simple">
<li>the objects that are being classified - the input space - which we will denote as <code class="docutils literal"><span class="pre">X</span></code> and which consists of <code class="docutils literal"><span class="pre">n_samples</span></code> that are represented using <code class="docutils literal"><span class="pre">n_features</span></code></li>
<li>the labels assigned to <code class="docutils literal"><span class="pre">n_samples</span></code> objects - an output space - which we will denote as <code class="docutils literal"><span class="pre">y</span></code>. <code class="docutils literal"><span class="pre">y</span></code> provides information about which, out of <code class="docutils literal"><span class="pre">n_labels</span></code> that are available, are actually assigned to each of <code class="docutils literal"><span class="pre">n_samples</span></code> objects</li>
</ul>
<div class="section" id="the-multi-label-data-representation">
<h2>The multi-label data representation<a class="headerlink" href="#the-multi-label-data-representation" title="Permalink to this headline">¶</a></h2>
<p>scikit-multilearn expects on input:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">X</span></code> to be a matrix of shape <code class="docutils literal"><span class="pre">(n_samples,</span> <span class="pre">n_features)</span></code></li>
<li><code class="docutils literal"><span class="pre">y</span></code> to be a matrix of shape <code class="docutils literal"><span class="pre">(n_samples,</span> <span class="pre">n_labels)</span></code></li>
</ul>
<p>By matrix scikit-multilearn understands following the <code class="docutils literal"><span class="pre">A[i,j]</span></code> element accessing scheme. Sparse matrices are preferred over dense ones. Scikit-multilearn will internally convert dense representations to sparse representations that are most suitable to a given classification procedure. Scikit-multilearn will output</p>
<p><code class="docutils literal"><span class="pre">X</span></code> can store any type of data a given classification method can handle is allowed, but nominal encoding is always helpful. Nominal encoding is enabled by default when loading data with <code class="xref py py-meth docutils literal"><span class="pre">skmultilearn.dataset.Dataset.load_arff_to_numpy()</span></code> helper, which also returns sparse representations of <code class="docutils literal"><span class="pre">X</span></code> and <code class="docutils literal"><span class="pre">y</span></code> loaded from ARFF data file.</p>
<p><code class="docutils literal"><span class="pre">y</span></code> is expected to be a binary <code class="docutils literal"><span class="pre">integer</span></code> indicator matrix of shape. In the binary indicator matrix each matrix element <code class="docutils literal"><span class="pre">A[i,j]</span></code> should be either <code class="docutils literal"><span class="pre">1</span></code> if label <code class="docutils literal"><span class="pre">j</span></code> is assigned to a object no <code class="docutils literal"><span class="pre">i</span></code>, and <code class="docutils literal"><span class="pre">0</span></code> if not.</p>
<p>We highly recommend for every multi-label output space to be stored in sparse matrices and expect scikit-multilearn classifiers to operate only on sparse binary label indicator matrices internally. This is also the format of predicted label assignments. Sparse representation is employed as default, because it is very rare for a real world output space <code class="docutils literal"><span class="pre">y</span></code> to be dense. Usually the number of labels assigned per instance is just a small portion of all labels. The average percentage of labels assigned per object is called <cite>label density</cite> and in established data sets it <a class="reference external" href="http://mulan.sourceforge.net/datasets-mlc.html">tends to be really small</a>.</p>
<p>All matrices should be compatible with the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matrix.html">numpy.matrix</a> or <a class="reference external" href="https://docs.scipy.org/doc/scipy-0.18.1/reference/sparse.html">scipy.sparse</a> classes, especially in terms of providing two-argument operator to access elements, i.e. the element of <code class="docutils literal"><span class="pre">i</span></code>-th row, <code class="docutils literal"><span class="pre">j</span></code>-th column of matrix <code class="docutils literal"><span class="pre">A</span></code> should be available via <code class="docutils literal"><span class="pre">A[i,j]</span></code> and not <code class="docutils literal"><span class="pre">A[i][j]</span></code>.</p>
</div>
<div class="section" id="single-label-representations-in-problem-transfortion">
<h2>Single-label representations in problem transfortion<a class="headerlink" href="#single-label-representations-in-problem-transfortion" title="Permalink to this headline">¶</a></h2>
<p>The problem transformation approach to multi-label classification converts multi-label problems to single-label problems: single-class or multi-class. Then those problems are solved using base classifiers. Scikit-multilearn maintains compatibility with <a class="reference external" href="http://scikit-learn.org/stable/modules/multiclass.html">scikit-learn data format for single-label classifiers</a> ,which expect:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">X</span></code> to have an <cite>(n_samples, n_features)</cite> shape and be one of the following:</p>
<blockquote>
<div><ul class="simple">
<li>an <code class="docutils literal"><span class="pre">array-like</span></code> of <code class="docutils literal"><span class="pre">array-likes</span></code>, which usually means a nested array, where <code class="docutils literal"><span class="pre">i</span></code>-th row and <code class="docutils literal"><span class="pre">j</span></code>-th column are adressed as <code class="docutils literal"><span class="pre">X[i][j]</span></code>, in many cases the classifiers expect <code class="docutils literal"><span class="pre">array-like</span></code> to be an <code class="docutils literal"><span class="pre">np.array</span></code></li>
<li>a dense matrix of the type <code class="docutils literal"><span class="pre">np.matrix</span></code></li>
<li>a scipy sparse matrix</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">y</span></code> to be a one-dimensional <code class="docutils literal"><span class="pre">array-like</span></code> of shape <code class="docutils literal"><span class="pre">(n_samples,)</span></code> with one class value per sample, which is a natural representation of a single-label problem</p>
</li>
</ul>
<p>Not all scikit-learn classifiers support matrix input and sparse representations. For this reason every scikit-multilearn classifier that follows a problem transformation approach admits a <code class="docutils literal"><span class="pre">require_dense</span></code> parameter in constructor. As these scikit-multilearn classifiers transform the multi-label problem to a set of single-label problems and solve them using scikit-learn base classifiers - the <code class="docutils literal"><span class="pre">require_dense</span></code> parameter allows control over which format of the transformed input and output space is forwarded to the base classifier.</p>
<p>The parameter <code class="docutils literal"><span class="pre">require_dense</span></code> expects a two-element list: <code class="docutils literal"><span class="pre">[bool</span> <span class="pre">or</span> <span class="pre">None,</span> <span class="pre">bool</span> <span class="pre">or</span> <span class="pre">None]</span></code> which control the input and output space formats respectively. If None - the base classifier will receive a dense representation if it is does not inherit <a class="reference internal" href="api/skmultilearn.base.html#skmultilearn.base.MLClassifierBase" title="skmultilearn.base.MLClassifierBase"><code class="xref py py-class docutils literal"><span class="pre">skmultilearn.base.MLClassifierBase</span></code></a>, otherwise the representation forwarded will be sparse. The dense representation for <code class="docutils literal"><span class="pre">X</span></code> is a <code class="docutils literal"><span class="pre">numpy.matrix</span></code>, while for <code class="docutils literal"><span class="pre">y</span></code> it is a <code class="docutils literal"><span class="pre">numpy.array</span> <span class="pre">of</span> <span class="pre">int</span></code> (scikit-learn&#8217;s required format of the output space).</p>
<p>Scikit-learn&#8217;s expected format is described <a class="reference external" href="http://scikit-learn.org/stable/modules/multiclass.html#multilabel-classification-format">in the scikit-learn docs</a> and assumes that:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">X</span></code> is provided either as a <code class="docutils literal"><span class="pre">numpy.matrix</span></code>, a <code class="docutils literal"><span class="pre">sparse.matrix</span></code> or as <code class="docutils literal"><span class="pre">array</span> <span class="pre">likes</span> <span class="pre">of</span> <span class="pre">arays</span> <span class="pre">likes</span></code> (vectors) of features, i.e. the array of row vectors that consist of input features (same length, i.e. feature/attribute count), ex. a two-object set with each row being a small 1px x 1px image with rgb channels (three <code class="docutils literal"><span class="pre">int8</span></code> values describing red, blue, green colors per pixel): <code class="docutils literal"><span class="pre">[[128,10,10,20,30,128],</span> <span class="pre">[10,155,30,10,155,10]]</span></code> - scikit-multilearn will expect a matrix representation and will forward a matrix representation to the base classifier</li>
<li><code class="docutils literal"><span class="pre">y</span></code> is expected to be provided as array of array likes</li>
</ul>
<p>Some scikit-learn classifiers support sparse representation of <code class="docutils literal"><span class="pre">X</span></code> especially for textual data, to have it forwarded as such to the scikit-learn classifier one needs to pass <code class="docutils literal"><span class="pre">require_dense</span> <span class="pre">=</span> <span class="pre">[False,</span> <span class="pre">None]</span></code> to the scikit-multilearn classifier&#8217;s constructor. If you are sure that the base classifier you use will be able to handle a sparse matrix representation of <code class="docutils literal"><span class="pre">y</span></code> - pass <code class="docutils literal"><span class="pre">require_dense</span> <span class="pre">=</span> <span class="pre">[None,</span> <span class="pre">False]</span></code>. Pass <code class="docutils literal"><span class="pre">require_dense</span> <span class="pre">=</span> <span class="pre">[False,</span> <span class="pre">False]</span></code> if both <code class="docutils literal"><span class="pre">X</span></code> and <code class="docutils literal"><span class="pre">y</span></code> are supported in sparse representation.</p>
</div>
<div class="section" id="converting-from-array-of-arrays">
<h2>Converting from array of arrays<a class="headerlink" href="#converting-from-array-of-arrays" title="Permalink to this headline">¶</a></h2>
<p>To convert from scikit-learn 1D representation of array of arrays to matrices, use a relevant scipy matrix/numpy matrix constructor, ex.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="kn">as</span> <span class="nn">sp</span>

<span class="c1"># assume X is array of arrays</span>
<span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># yields a dense matrix</span>
<span class="n">sp</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># yields a row-oriented sparse matrix</span>
</pre></div>
</div>
<p>In the next section we explain how to generate and where to get data for multi-label classification.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="loading.html" class="btn btn-neutral float-right" title="Loading and generating multi-label datasets" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="concepts.html" class="btn btn-neutral" title="Concepts guide" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>